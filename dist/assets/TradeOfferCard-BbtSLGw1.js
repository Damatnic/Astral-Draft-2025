import{R as b,j as e,m as U,p as M,a as w,S as I,A as k}from"./index-COBmtdYu.js";import{M as $}from"./Modal-B7Hn7XWX.js";import{L as G,M as L}from"./geminiService-1862MQGr.js";import{L as F}from"./LoadingSpinner-DSQnnH7P.js";import{M as H}from"./index-CwQkY9CC.js";const W=({offer:a,league:s,onClose:m})=>{const[l,p]=b.useState(null),[f,r]=b.useState(!0);return b.useEffect(()=>{(async()=>{r(!0);const o=await G();p(o),r(!1)})()},[a,s]),e.jsxDEV($,{onClose:m,children:e.jsxDEV(U.div,{className:"glass-pane rounded-xl shadow-2xl w-full max-w-2xl max-h-[80vh] flex flex-col",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},children:[e.jsxDEV("header",{className:"p-4 border-b border-[var(--panel-border)] text-center",children:e.jsxDEV("h2",{className:"text-xl font-bold font-display",children:"The Story of the Trade"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:40,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:39,columnNumber:17},void 0),e.jsxDEV("main",{className:"p-6 overflow-y-auto",children:f?e.jsxDEV(F,{text:"Analyzing the trade's fallout..."},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:43,columnNumber:34},void 0):l?e.jsxDEV("div",{className:"prose prose-sm prose-invert prose-headings:text-cyan-300 prose-strong:text-yellow-300",children:[e.jsxDEV("h2",{children:l.title},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:46,columnNumber:28},void 0),e.jsxDEV("p",{className:"lead",children:[e.jsxDEV("strong",{children:"Winner Declared:"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:47,columnNumber:48},void 0)," ",l.winnerDeclared]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:47,columnNumber:28},void 0),e.jsxDEV(H,{children:l.narrative},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:48,columnNumber:28},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:45,columnNumber:25},void 0):e.jsxDEV("p",{className:"text-center text-red-400",children:"Could not generate a story for this trade."},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:51,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:42,columnNumber:17},void 0),e.jsxDEV("footer",{className:"p-4 border-t border-[var(--panel-border)] text-center",children:e.jsxDEV("button",{onClick:m,className:"px-6 py-2 bg-cyan-500 text-black font-bold text-sm rounded-md",children:"Close"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:55,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:54,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:32,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/modals/TradeStoryModal.tsx",lineNumber:31,columnNumber:9},void 0)},q=({className:a})=>e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:a||"h-5 w-5",children:[e.jsxDEV("path",{d:"M8 21h12a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H8"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:6,columnNumber:9},void 0),e.jsxDEV("path",{d:"M6 17H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:7,columnNumber:9},void 0),e.jsxDEV("path",{d:"M16 17h2"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:8,columnNumber:9},void 0),e.jsxDEV("path",{d:"M15 13h2"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:9,columnNumber:9},void 0),e.jsxDEV("path",{d:"M13 9h2"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:10,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/icons/ScrollTextIcon.tsx",lineNumber:5,columnNumber:5},void 0),B={PENDING:{bg:"bg-yellow-500/10",text:"text-yellow-300",label:"Pending"},ACCEPTED:{bg:"bg-green-500/10",text:"text-green-300",label:"Accepted"},REJECTED:{bg:"bg-red-500/10",text:"text-red-400",label:"Rejected"},VETOED:{bg:"bg-red-900/20",text:"text-red-400",label:"Vetoed"},FORCED:{bg:"bg-green-900/20",text:"text-green-300",label:"Forced"}},Z=({offer:a,league:s,myTeamId:m,dispatch:l})=>{const[p,f]=b.useState(!1),r=a.toTeamId===m,S=r?a.fromTeamId:a.toTeamId,o=s.teams.find(t=>t.id===S),v=s.teams.find(t=>t.id===m),O=new Map(M.map(t=>[t.id,t])),E=a.playersOffered.map(t=>O.get(t)),D=a.playersRequested.map(t=>O.get(t)),u=a.draftPicksOffered||[],x=a.draftPicksRequested||[],A=r?D:E,g=r?E:D,P=r?x:u,R=r?u:x,i=B[a?.status],C=(()=>{if(!a.tradeAnalysis||!a.tradeAnalysis.winner)return{text:"",color:"text-gray-400"};switch(a.tradeAnalysis.winner){case"TEAM_A":return{text:`${v.name} Wins`,color:"text-green-400"};case"TEAM_B":return{text:`${o?.name} Wins`,color:"text-red-400"};case"EVEN":return{text:"Fair Trade",color:"text-yellow-400"};default:return{text:"Analysis available",color:"text-cyan-400"}}})(),T=async t=>{if(l({type:"UPDATE_TRADE_STATUS",payload:{leagueId:s.id,tradeId:a.id,status:t}}),l({type:"ADD_NOTIFICATION",payload:{message:`Trade offer ${t.toLowerCase()}!`,type:"TRADE"}}),t==="ACCEPTED"&&o){const c=s.teams.find(d=>d.id===a.fromTeamId),n=s.teams.find(d=>d.id===a.toTeamId),N=d=>d.map(h=>`${h.season} R${h.round}`).join(", "),j=u.length>0?` and picks (${N(u)})`:"",_=x.length>0?` and picks (${N(x)})`:"";`${c.name}${E.map(d=>d?.name).join(", ")}${j}${n.name}${D.map(d=>d?.name).join(", ")}${_}`;const V=await L();l({type:"ADD_CHAT_MESSAGE",payload:{leagueId:s.id,message:{user:{id:"system",name:"League Event",avatar:"ðŸ“£"},text:"",isSystemMessage:!0,tradeEvent:a,aiHotTake:V||void 0}}})}},y=({players:t,picks:c})=>e.jsxDEV("div",{className:"text-xs space-y-1",children:[t.length>0&&t.map(n=>n&&e.jsxDEV("p",{children:[n.name," (",n.position,")"]},n.id,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:103,columnNumber:58},void 0)),c.length>0&&c.map((n,N)=>e.jsxDEV("p",{className:"text-cyan-300",children:[n.season," R",n.round," Pick"]},N,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:104,columnNumber:54},void 0)),t.length===0&&c.length===0&&e.jsxDEV("p",{className:"text-gray-500 italic",children:"Nothing"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:105,columnNumber:60},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:102,columnNumber:9},void 0);return e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:`p-3 rounded-lg ${i.bg} border-l-4 ${i.text.replace("text-","border-")}`,children:[e.jsxDEV("div",{className:"flex justify-between items-start text-xs",children:[e.jsxDEV("p",{children:r?`From: ${o?.name}`:`To: ${o?.name}`},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:113,columnNumber:17},void 0),e.jsxDEV("span",{className:`px-2 py-0.5 rounded-full font-semibold text-xs ${i.bg} ${i.text}`,children:i.label},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:114,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:112,columnNumber:13},void 0),e.jsxDEV("div",{className:"grid grid-cols-[1fr_auto_1fr] gap-2 items-start my-2",children:[e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-bold text-red-400 text-xs mb-1",children:"GIVING"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:119,columnNumber:21},void 0),e.jsxDEV(y,{players:A,picks:P},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:120,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:118,columnNumber:17},void 0),e.jsxDEV("div",{className:"pt-4",children:e.jsxDEV(w,{className:"w-5 h-5 text-gray-400"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:123,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:122,columnNumber:17},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"font-bold text-green-400 text-xs mb-1",children:"GETTING"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:126,columnNumber:21},void 0),e.jsxDEV(y,{players:g,picks:R},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:127,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:125,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:117,columnNumber:13},void 0),a.tradeAnalysis&&e.jsxDEV("div",{className:"text-xs mt-2 pt-2 border-t border-white/10 flex items-center justify-center gap-2",children:[e.jsxDEV(I,{className:`w-3 h-3 ${C.color}`},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:133,columnNumber:21},void 0),e.jsxDEV("span",{className:`font-bold ${C.color}`,children:[C.text,":"]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:134,columnNumber:21},void 0),e.jsxDEV("span",{className:"italic text-gray-400",children:['"',a.tradeAnalysis.summary,'"']},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:135,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:132,columnNumber:18},void 0),r&&a?.status==="PENDING"&&e.jsxDEV("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsxDEV("button",{onClick:()=>T("REJECTED"),className:"px-3 py-1 text-xs font-bold bg-red-500/20 text-red-300 rounded-md hover:bg-red-500/30",children:"Reject"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:141,columnNumber:21},void 0),e.jsxDEV("button",{onClick:()=>T("ACCEPTED"),className:"px-3 py-1 text-xs font-bold bg-green-500/20 text-green-300 rounded-md hover:bg-green-500/30",children:"Accept"},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:144,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:140,columnNumber:17},void 0),a?.status!=="PENDING"&&m!==-1&&e.jsxDEV("div",{className:"flex justify-end mt-2",children:e.jsxDEV("button",{onClick:()=>f(!0),className:"flex items-center gap-1.5 px-3 py-1 text-xs font-bold bg-purple-500/20 text-purple-300 rounded-md hover:bg-purple-500/30",children:[e.jsxDEV(q,{},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:152,columnNumber:25},void 0)," View Story"]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:151,columnNumber:21},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:150,columnNumber:18},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:111,columnNumber:9},void 0),e.jsxDEV(k,{children:p&&e.jsxDEV(W,{offer:a,league:s,onClose:()=>f(!1)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:159,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:157,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/damat/_REPOS/Astral Draft/components/team/TradeOfferCard.tsx",lineNumber:110,columnNumber:9},void 0)};export{Z as T};
