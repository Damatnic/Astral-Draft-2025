{"version":3,"file":"LeagueNewspaperView-Dm9y5IgI.js","sources":["../../views/LeagueNewspaperView.tsx"],"sourcesContent":["\n\nimport React from 'react';\nimport { useAppState } from '../contexts/AppContext';\nimport { useLeague } from '../hooks/useLeague';\nimport { Widget } from '../components/ui/Widget';\nimport ErrorDisplay from '../components/core/ErrorDisplay';\nimport { NewspaperIcon } from '../components/icons/NewspaperIcon';\nimport { generateLeagueNewspaperContent } from '../services/geminiService';\nimport LoadingSpinner from '../components/ui/LoadingSpinner';\nimport type { NewspaperContent } from '../types';\nimport ReactMarkdown from 'react-markdown';\nimport { motion } from 'framer-motion';\n\nconst LeagueNewspaperView: React.FC = () => {\n    const { state, dispatch } = useAppState();\n    const { league } = useLeague();\n    const [newspaper, setNewspaper] = React.useState<NewspaperContent | null>(null);\n    const [isLoading, setIsLoading] = React.useState(true);\n    const [error, setError] = React.useState<string | null>(null);\n    const [selectedWeek, setSelectedWeek] = React.useState(league ? (league.currentWeek > 1 ? league.currentWeek - 1 : 1) : 1);\n    \n    const maxWeek = league ? league.currentWeek - 1 : 0;\n    const cacheKey = league ? `${league.id}_${selectedWeek}` : '';\n\n    React.useEffect(() => {\n        if (!league || !cacheKey || maxWeek < 1) {\n            setIsLoading(false);\n            return;\n        }\n\n        const cachedNewspaper = state.leagueNewspapers[cacheKey];\n        if (cachedNewspaper) {\n            setNewspaper(cachedNewspaper);\n            setIsLoading(false);\n            return;\n        }\n\n        setIsLoading(true);\n        setError(null);\n        generateLeagueNewspaperContent(league, selectedWeek)\n            .then(data => {\n                if (data) {\n                    setNewspaper(data);\n                    dispatch({ type: 'SET_LEAGUE_NEWSPAPER', payload: { key: cacheKey, newspaper: data } });\n                } else {\n                    setError(\"The Oracle could not write this week's newspaper.\");\n                }\n            })\n            .catch(() => setError(\"An error occurred while consulting the Oracle.\"))\n            .finally(() => setIsLoading(false));\n\n    }, [league, selectedWeek, cacheKey, state.leagueNewspapers, dispatch, maxWeek]);\n\n    if (!league) {\n        return <ErrorDisplay title=\"Error\" message=\"Please select a league.\" onRetry={() => dispatch({ type: 'SET_VIEW', payload: 'DASHBOARD' })} />;\n    }\n     if (maxWeek < 1) {\n        return <ErrorDisplay title=\"Not Available\" message=\"The newspaper will be published after Week 1 is complete.\" onRetry={() => dispatch({ type: 'SET_VIEW', payload: 'LEAGUE_HUB' })} />;\n    }\n\n    return (\n        <div className=\"w-full h-full flex flex-col p-4 sm:p-6 lg:p-8 overflow-y-auto\">\n            <header className=\"flex-shrink-0 flex justify-between items-center mb-6\">\n                <div>\n                    <h1 className=\"font-display text-3xl sm:text-4xl font-extrabold tracking-wider uppercase text-[var(--text-primary)]\">\n                        League Newspaper\n                    </h1>\n                    <p className=\"text-sm text-[var(--text-secondary)] tracking-widest\">{league.name}</p>\n                </div>\n                <div className=\"flex items-center gap-4\">\n                     <div className=\"flex items-center gap-2\">\n                        <button onClick={() => setSelectedWeek(w => w - 1)} disabled={selectedWeek <= 1} className=\"px-3 py-1 bg-white/10 rounded-lg text-sm hover:bg-white/20 disabled:opacity-50\">\n                            &lt;\n                        </button>\n                        <span className=\"font-bold w-24 text-center\">Week {selectedWeek} Issue</span>\n                        <button onClick={() => setSelectedWeek(w => w + 1)} disabled={selectedWeek >= maxWeek} className=\"px-3 py-1 bg-white/10 rounded-lg text-sm hover:bg-white/20 disabled:opacity-50\">\n                            &gt;\n                        </button>\n                    </div>\n                    <button onClick={() => dispatch({ type: 'SET_VIEW', payload: 'LEAGUE_HUB' })} className=\"px-4 py-2 bg-white/10 rounded-lg text-sm hover:bg-white/20\">\n                        Back to League Hub\n                    </button>\n                </div>\n            </header>\n            <main className=\"flex-grow glass-pane rounded-2xl overflow-hidden\">\n                <div className=\"p-6 md:p-8 h-full overflow-y-auto\">\n                    {isLoading ? <LoadingSpinner text=\"The Oracle is on deadline...\" /> :\n                     error ? <ErrorDisplay message={error} /> :\n                     newspaper ? (\n                        <motion.div\n                            key={selectedWeek}\n                            {...{\n                                initial: { opacity: 0 },\n                                animate: { opacity: 1 },\n                            }}\n                        >\n                            <h2 className=\"font-display text-4xl font-black text-center border-b-4 border-double border-white/50 pb-2 mb-4\">\n                                {newspaper.masthead}\n                            </h2>\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                                <div className=\"md:col-span-2 prose prose-sm prose-invert prose-headings:text-cyan-300\">\n                                    <h3>{newspaper.leadStory.headline}</h3>\n                                    <ReactMarkdown>{newspaper.leadStory.content}</ReactMarkdown>\n                                </div>\n                                <div className=\"space-y-6\">\n                                    {newspaper.articles.map((article, i) => (\n                                        <div key={i} className=\"prose prose-sm prose-invert prose-headings:text-cyan-300\">\n                                            <h4>{article.headline}</h4>\n                                            <ReactMarkdown>{article.content}</ReactMarkdown>\n                                        </div>\n                                    ))}\n                                </div>\n                            </div>\n                        </motion.div>\n                     ) : null}\n                </div>\n            </main>\n        </div>\n    );\n};\n\nexport default LeagueNewspaperView;\n"],"names":["LeagueNewspaperView","state","dispatch","useAppState","league","useLeague","newspaper","setNewspaper","React","isLoading","setIsLoading","error","setError","selectedWeek","setSelectedWeek","maxWeek","cacheKey","cachedNewspaper","generateLeagueNewspaperContent","data","jsxDEV","ErrorDisplay","this","w","LoadingSpinner","motion","ReactMarkdown","article","i"],"mappings":"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"}